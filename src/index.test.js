import assert from 'node:assert';
import test from 'node:test';

import * as util from './index.js';

// let hash = await util.hashFile('test.json');
// console.log(hash);

test('verfy mldsa44 signature', () => {
  const data =
      '{"id":"12D3KooWJtaFQCRPKXWHqEUq2xUB3NG61Z3s8BeTzwkJNZbsLMML","name":"garat"}';
  const key =
      "6ac80b0d60c753f08cf88ed5ed39a6fcf3c7114cc1295626d6d77a87ded8d2ddf515e413d4307c138e5c315dde3d0b1858b6c43b1032590851aec061c5a14464368b6d4b66f2592d32a45701c38a9a0b61ef68899896098867d95faa9897f028638c18fae295f459a0a93cf9395b6885e7cf918dbb6a14f5f8a3df839147a281d159e3d74ff61dc7ee520e4640cb40dfe2be0e66277e627816ac85532a39f008ef018e79457d257d2b0b43ca0a81f5f69b3ab5bede5477a60f1add4bf84f54250e35614a9ae9a55adec163bdb2d5f12027f8b031ebd28f2293bb5fb624377c5ea28ed95e559aa3fe9697ccdc048cfa05fb5cfeaf3f195fcb41b6db11c0b17219a0982f51961d5f060a7db6837e4541fc69b431ace6b1e55515fc6fb3de5d4953d178340fbabd89565c29193b1240bd270cce86e1c23dbb0a846d67e2c06ab601796e93007fa45da2c8b4701ca1269b6249d1a1424d0b73afb118c920be87120ca37ce561b6538c1b2cee066a118f866afc869b342ea37b4b4de46e094a79a9debfa6be8fb42d96352b03b62b856f0bc673157c6d72ff6e1765fc98ec6d038d6f413fdb64d877382b9dccdd19f2ebda2c79314e6f7e8bcd4cc62dbd0a7d6ee55d9c956891c115c0756077c5ec628102ab6571a91e0946a4a4906f3a9f97a3d68a8fb32cc591d889e45de067362aac5380a0ea7a52ad8b30967ccaac1fcf20470a2c245f4ff5f676941fdcd4adedf7b82b404991aac80ed73e2a541b1b4c00fb6f0a36d7864ad76165f340248de94c7dcf13a59a67b9adb78edf3787d5696e0993811e175e8d6aba1cddd900206d124b5a71bbc17f4355180536c5aeb830a5d4c31844106110a72df65f074cc98b7127608e6b15950d984acdb7fa6b2fa9e1c426f171d64e14c89dce5cabfd926cfa17ff04a1a709bbc13487f9727d2517ab318971baafa944964cf2db3027e3a7dc13afe6d8ec37496920e4450193751ccd0798f7aae01e6339a5da9973228eb81c5cde3b81feb6ae2aa79bbda4f58931a35ec008d36e0f69821f53dace67b1139576b05367652d6b683b4a98dda839f53fc9be140f3bcf43f87fcc324a9c4840d6dee82d4e68902eaa7a51dbe27bc735ad471c488f0a0f42f519fe55b7325a6ace7ac37c7826f45ada0155289e68394fb70f07212fda575f5aafcc25fbc1a6a4908dff99d0cfa5886a5f010bbe606f96bf50376b1969fcac2120134dd2bbe480c902585a3bed509c90ae60c2d85fcd74c94ac72f61b2fee9f0b5a8c60ba24a8a8c2da13d82c22ff8ee790c51af807a926a0837c837b73168a45311530b09c4fe7a55947d7382a17b0b9a3b4b45f1581e611caf6bbb0b94486c4e3da04be8f069a68a3471f2a0dc9a4037cd6fef2acf7d021753e3cd93132cecb2433782e2933324519f45ed31f584adf9fbf2b62b56b56fb9ac85fd96120aa9d81ff7a0107b5a0f6526dd509298a113744f3d14e0db425a2fcc077282933adabc939aefa01055d2416e0065c1ef7b8881d5406474109d4303884aded6a6ddaf15f5481dec2f4490d2faa9aa0ac8e3cb002ff81455f29b8226515f7ac35716656f544d900877f80b5da0f658edfac380cebfc8da25358762126d90d9890ac07af6bd3afd06aef5bd17f0daf8c6bc5ee0b59172164714578af10b9aa398565db5f997d9c7ac79381efbd4a95e4b5fb714fc386e4bca244555095a564229ec9d9daf4e0c8bd6875492bbfc42929d0ccbc8a3986045c9f80e342d148f50f93d6a3bf401a3caf4ad567806909b19ee82f85dd39a03a76df9782286e92ebc340b74f1ddf273b43d611d02e4322674897ed5c2491997dfd3c2ea28fc86";
  const sig =
      "834ccbb1c7c80480bb7624084d8f73e121afd468c2eb0e744814d6fe28400168efde655875cd9e6c63cd14f67cccc8a14e63c9a7410129e06dad7b5c49887f0768060743ab19fabb3682f1a2686e2820dd1d7cc882dd44eae1759ce34cbe922d1e098aa9828d2438d857c34b6e1a37426c36c4fc83ad7b946f77d747000f58aa08b44145f6090f27e456f3dd9ab105acf9a5fb44d65e10880fc39201f7f4aa1a285c6769d0903bb6e10cb2411f6c628d19fa05fa740b2fcab1969c846222296f98c66ae0d4324d06e991e3cf5aa86949c48208cbe2cf9276681e70f53217ddd34524693e807c6058347b2ca8b307e3415a077556d4f24f2268af87ba6c9182ceab1f85ffd07647055f7dcef0129bd48b809d2297d72c57d919e984d4dde54e1dd5c36cf5533bff13a40f9e25389a960dcdfc6e09624663e2a778f4cc51ac08b71b74b80c568bb1b0c5daf93147797dbe5f53e8f34c0a2a75506cfe1fa9f49ed711581947a34840381e9964bfba2e6fc979f768da8b6d74d957b1b17ba14e8a03d007c6a61b72fcbf597e13f85587c28dc2f32947c9f5681e0ee2c549971faf2d8c75c1b6d6616428618de116ed41d25e303a998a2ebcc6ac8aa0ac2e33e3ca4b312cb513fcbd99a43887b413b731938849b151c981df8b8ae4e3282a986b52e4b8ed4db5f040f9d265436b3d4064dff2eb088b0c152081658d3ffaabb0df03d2d0c271ba3fd1464a1da35be2e0443c9d5d6bcdbf1fe0b78eddab6ccb21d6398eefdda6ca80d8a880160032642e0d35c10a7ec00c8aa627fd764be625a76818b5a2f49851aca9a9f8bd991603969f7d9ade4a6791ba115f7f558423e08097e22294f70c79e32700541221980f49153ae9f5953922ee8368f389f018d716d84f031c9083875c49db1db0e5af704f9e78ea75e50a445c065bea66e11029fb938ce6c74c0928caf86d8e2bc3951df1f67112951e9a38079fa260d8fd1b4feffb8eb5d56af9c91a40a32a2ddc1b657a183a275a4d0e597a877791554cce0ad73cb3c173a052c8c9604eb905dd98bf0ba147562913b7f362152f1bb1110d69abe3776b76627ea5eaef6c8b89082c3c746f7f4afeb897fdaf551b8b53ee2108f141e4bec81c58ffeabe2549be4267f40a8f7b36388426c95a1fcbb45a64a0889ee92122f1c7e39a2afad919e61107190d840a2abe94f71950604698c1304914b58d6f9c2a116db8e5e6365461af61471ce003debe2bde4db61f36a7dad692ca5ce86425a154957533b11b608d88ef5b514415023fb40c3ebf7eebf1e2a81869c328d4e76a999eb9fd27209cd5a404751e0a32694dfe0c0828aff3adafe177071764efba9e2d80866db80d8fbdb8dc3951ae40004192c178df599ff7654b8cebc4238fa11060ed56e1e1f0a04ba99bbe7e78e4bd9e5b58da4a4e23498978883bec3d0a6f2930747c61a3c3b6ae75f0b0e59730355b7fcc04914098cbb474bc41d72d32415699e4ff6243a660aa01566f48f4e4d0f556297be89c839ec033e4255d3371088701a6cb38ef1edec83edf906d5a8702cbf71d99b3ace40b60b6b2739316077f7f135a7bbf312f62765e6762d9363450cd2fcce195cf2449a39d77d4e52c4d864135faaf53cac964839b436043c0129995df7971c81eb8fe6c5b4bf5b58cc569d62c9d1443c6aceae8a641723277f2a5cf3bfd10e9a59f42f2787d5aeb562da17dca72c344cb05dd65a37e285cfa158e3591426897e127cdc91b20c5f878abf96c73d4077539fb726a65418c976c2578cfee8a67bafe99f802db177da339816413178963d0dc071a238d182fd77d6531c4f635882950d42a77af83f85dfb0867239c1cff2f0246357ebb6533560078aaedd5355737b0089221f217fd63e4a21c8294bba34b1269bc567cc53c20ca48cee151af6411e2624ef0eaf9e1d46239dcbc5343e538f67515d3f7e16edde587265a09842e358992bc45236f398a669892a12262b5a7d8cd777d09dfe6ebce92aaf377a34ed7aa497cfbdf8ddfdefae8ab10beccf9e2e9d092ae563f26d113503a9e56e271aa72a2f8b8b1641c1c5d05a7378fb96c2af860f831e96f9eedf1360aa43a9e504fbbea6d8127d1c08e0d14d938cf0913a7d7f076e00c57f5f3a218aff0b9f2bf090a2e87cde4b6d47e5e7eacd49b958e0f25ee1c1bf57cdd72a7708b85b834c6af226d7e2c571e45e9a898116d5b869238f314f51c644d572c0c127657122df2d91b7deff1c8080534b89432269bc39a32529394d14be878143a8d5a470744bb0c5c6f6891d4b9a6b446f2c9d71802c5b3a0825699d589903963d1d22f5bf8dbaecb7b4b005282fe301f4f187afa6e054a5095782990fad00279118dfa848a7e1529ba5456261eadc1357ba1265a40d82b32a9f95d8abfc727540e2d07988b8be498d275cee9ed91ab23294bcd1a9575b8e330649a6f517f2e3cd6abc99e94498efb99c3dc3c7ec2c045f08021f165ee31dca1b2c552b9a334cdba136681c2b526e515b234a9f2a4eb28f35e912bea0a217514d271404a073225276d316e0b8e27edcb20f410007c8234b1932593dd4827d223e7030270eb7b3189757edd63b19b7f71e85770bbc815ddca5550efdda786b65967412c9fc0d1124136cdaa7a298f9147e0e65d76f98d1729db4a6c675618ce3d9cd2c15369e2b904a418c67cc918445c1f85c59bab7c72368992356504a1ce2c0839f3ce0ab9e5d1fee2570e3dfb53935d4a41692e7a74e7a01501754763f30760619d5e8d5c7d469bb3032363c546af81b469febef487b21674883713ecff4595196214ab8b69e83d11294b6161e86e1b94110cb378389554ab80190c1ffa3c97188fa7aecc2517988116c5f25084772b0d5dbfa5c95107d6e78062c71abe0971c01c35eb7490ec39b7f20788b7230d055f8c9f2fb2313b5e11f699b64ec48caaf4953256aa1b2093af6eea73a044d3222d5ab78a8b1c9726141e6ee35164e7692ddac4fee93abeab6b2d7bb83ad77525cf2041f76a3210ac557cdff0382f2689f4d26276536f2e617d86937eb2d681ea99c65cf73411baa4f652b5e9dc4bf49a7968aa791d7e42e971d29bf01c6aaeac426ef0c10ce5bf38599011030760fd3354023f94229e4b946deec7fdd758a06bafd3d31549d609d105e79c7e3956edafd19637abcc3785da27cb4fe46673246571348e2f0b1e6be0ad4d37fb1b0a375c618db619dcc8202be87211fb96564e0d46d64dcc529078f03bb17a5ee28c14bb5de4cb2175c76c43a8e214dc7cf0026a4f592e9265a8ae700813181920212b2c2d3e768386898c92cad6e908182a3f52a5adaef5f6fa04070b182548566162687a82afb5c9dae1ef0813181f26363c5b6d94a6abb2b4d8dee0e4e7eceff1f3f40000000000000000131e3048";
  assert.ok(util.verifySignature(data, key, sig));
});
